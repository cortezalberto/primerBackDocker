# API REST de Gesti√≥n de Usuarios con Spring Boot

<div align="center">

![Java](https://img.shields.io/badge/Java-17-orange?style=for-the-badge&logo=java)
![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.5.6-brightgreen?style=for-the-badge&logo=spring-boot)
![Gradle](https://img.shields.io/badge/Gradle-8.14-02303A?style=for-the-badge&logo=gradle)
![H2](https://img.shields.io/badge/H2-Database-blue?style=for-the-badge)
![License](https://img.shields.io/badge/License-Educational-yellow?style=for-the-badge)

**API REST educativa con arquitectura en tres capas, validaciones robustas, documentaci√≥n OpenAPI autom√°tica y manejo global de excepciones**

[Caracter√≠sticas](#caracter√≠sticas) ‚Ä¢
[Instalaci√≥n](#instalaci√≥n-r√°pida) ‚Ä¢
[Uso](#gu√≠a-de-uso) ‚Ä¢
[API](#documentaci√≥n-de-la-api) ‚Ä¢
[Arquitectura](#arquitectura-t√©cnica)

</div>

---

## Tabla de Contenidos

- [Descripci√≥n del Proyecto](#descripci√≥n-del-proyecto)
- [Caracter√≠sticas Principales](#caracter√≠sticas-principales)
- [Stack Tecnol√≥gico](#stack-tecnol√≥gico)
- [Requisitos Previos](#requisitos-previos)
- [Instalaci√≥n R√°pida](#instalaci√≥n-r√°pida)
- [Gu√≠a de Uso](#gu√≠a-de-uso)
  - [Ejecutar la Aplicaci√≥n](#ejecutar-la-aplicaci√≥n)
  - [Compilar y Generar JAR](#compilar-y-generar-jar)
  - [Ejecutar Tests](#ejecutar-tests)
  - [Generar Documentaci√≥n JavaDoc](#generar-documentaci√≥n-javadoc)
- [Documentaci√≥n de la API](#documentaci√≥n-de-la-api)
  - [Endpoints Disponibles](#endpoints-disponibles)
  - [Ejemplos de Peticiones](#ejemplos-de-peticiones)
- [Arquitectura T√©cnica](#arquitectura-t√©cnica)
  - [Patr√≥n de Tres Capas](#patr√≥n-de-tres-capas)
  - [Flujo de Datos](#flujo-de-datos)
  - [Modelo de Dominio](#modelo-de-dominio)
- [Configuraci√≥n CORS](#configuraci√≥n-cors)
- [Manejo de Errores](#manejo-de-errores)
- [Base de Datos](#base-de-datos)
- [Seguridad](#consideraciones-de-seguridad)
- [Documentaci√≥n Adicional](#documentaci√≥n-adicional)
- [Autor](#autor)

---

## Descripci√≥n del Proyecto

Este proyecto es una **API REST educativa** desarrollada con **Spring Boot 3.5.6** que implementa un sistema completo de gesti√≥n de usuarios (CRUD - Create, Read, Update, Delete). Est√° dise√±ado espec√≠ficamente para **estudiantes de inform√°tica** que desean aprender las mejores pr√°cticas de desarrollo backend con Spring Framework mediante un ejemplo pr√°ctico y completamente documentado.

### üéØ ¬øQu√© hace este proyecto?

Esta API proporciona un **backend completo y funcional** que simula un sistema real de gesti√≥n de usuarios, permitiendo:

- ‚úÖ **Crear nuevos usuarios** con validaci√≥n autom√°tica de datos (nombre, email, password)
- ‚úÖ **Listar todos los usuarios** registrados en el sistema
- ‚úÖ **Consultar un usuario espec√≠fico** por su identificador √∫nico (ID)
- ‚úÖ **Actualizar informaci√≥n** de usuarios existentes de forma completa
- ‚úÖ **Eliminar usuarios** del sistema de manera segura
- ‚úÖ **Documentaci√≥n interactiva** autom√°tica con Swagger UI para probar endpoints
- ‚úÖ **Manejo centralizado de errores** con respuestas estandarizadas en formato JSON
- ‚úÖ **Soporte CORS** configurado para integraci√≥n con aplicaciones frontend (React, Angular, Vue)

### üìö ¬øPor qu√© es educativo?

Este proyecto va m√°s all√° de un simple CRUD. Est√° dise√±ado como una **herramienta de aprendizaje completa** que cubre:

#### 1. Arquitectura Profesional
- **Patr√≥n de tres capas** (Controller ‚Üí Service ‚Üí Repository) que separa responsabilidades claramente
- **Inyecci√≥n de dependencias** con Spring para bajo acoplamiento
- **Separaci√≥n de DTOs y Entities** para mantener contratos de API independientes de la l√≥gica interna

#### 2. Pr√°cticas Modernas de Java
- **Java 17** con caracter√≠sticas modernas como Records para DTOs inmutables
- **Lombok** para reducir c√≥digo boilerplate (@Data, @Builder, @RequiredArgsConstructor)
- **Streams API** y programaci√≥n funcional (map, filter, Optional, Method References)
- **Pattern Builder** para construcci√≥n elegante de objetos

#### 3. Spring Boot en Acci√≥n
- **Spring Data JPA** con Hibernate para persistencia autom√°tica
- **Bean Validation** (@NotBlank, @Email, @Size) para validaci√≥n declarativa
- **@Transactional** para gesti√≥n autom√°tica de transacciones
- **@ControllerAdvice** para manejo global de excepciones
- **Profiles** de configuraci√≥n (dev/prod) para diferentes entornos

#### 4. Seguridad y Robustez
- **Prevenci√≥n de race conditions** (TOCTOU - Time-Of-Check-Time-Of-Use)
- **Validaci√≥n en m√∫ltiples capas** (DTOs + Service + Database constraints)
- **C√≥digos HTTP sem√°nticos** correctos (200, 201, 204, 400, 409, 500)
- **Exclusi√≥n de datos sensibles** en respuestas (password nunca se retorna)

#### 5. Documentaci√≥n Profesional
- **+2000 l√≠neas de JavaDoc en espa√±ol** explicando cada concepto
- **OpenAPI/Swagger** generado autom√°ticamente
- **README completo** con ejemplos de uso en m√∫ltiples lenguajes
- **CLAUDE.md** con arquitectura t√©cnica detallada

### üéì Prop√≥sito Educativo

El c√≥digo incluye **documentaci√≥n JavaDoc exhaustiva en espa√±ol** que explica paso a paso:

| Tema | Descripci√≥n | Ubicaci√≥n |
|------|-------------|-----------|
| **Arquitectura en Capas** | Separaci√≥n de responsabilidades entre Controller, Service, Repository | Todas las clases |
| **Inyecci√≥n de Dependencias** | C√≥mo Spring gestiona dependencias con @Autowired y constructores | UsuarioController, UsuarioService |
| **Patrones de Dise√±o** | Builder, Factory Method, DTO, Repository | Usuario (Builder), UsuarioResponseDTO (Factory) |
| **Anotaciones Spring** | @Service, @Transactional, @Valid, @ControllerAdvice, @RestController | Cada clase del proyecto |
| **Gesti√≥n de Transacciones** | Cu√°ndo y por qu√© usar @Transactional, atomicidad de operaciones | UsuarioService.java |
| **Prevenci√≥n de Race Conditions** | Patr√≥n TOCTOU y validaci√≥n at√≥mica en operaciones concurrentes | UsuarioService.eliminarUsuario() |
| **API Funcional de Java** | Optional, Streams, map(), Method References (::) | UsuarioService.listarUsuarios() |
| **Bean Validation** | Validaci√≥n declarativa con annotations (@NotBlank, @Email) | UsuarioRequestDTO.java |
| **Manejo de Excepciones** | Captura global con @ControllerAdvice, respuestas estandarizadas | GlobalExceptionHandler.java |
| **HTTP Status Codes** | Sem√°ntica correcta de c√≥digos HTTP (200 vs 201 vs 204) | UsuarioController.java |
| **Seguridad de Datos** | Por qu√© excluir passwords de respuestas, DTOs vs Entities | UsuarioResponseDTO.java |

### üîç Ejemplo de Flujo Completo

Para ilustrar mejor c√≥mo funciona el proyecto, veamos qu√© sucede cuando un cliente crea un usuario:

```
1. Cliente env√≠a petici√≥n HTTP:
   POST http://localhost:8080/api/usuarios
   {
     "nombre": "Mar√≠a Garc√≠a",
     "email": "maria@example.com",
     "password": "secreta123"
   }

2. UsuarioController recibe la petici√≥n:
   - Jackson convierte JSON a UsuarioRequestDTO
   - @Valid activa validaciones Bean Validation
   - Si nombre vac√≠o o email inv√°lido ‚Üí ERROR 400
   - Si validaci√≥n OK ‚Üí Llama a UsuarioService

3. UsuarioService procesa la l√≥gica de negocio:
   - @Transactional inicia transacci√≥n de BD
   - Convierte DTO a Entity usando Builder:
     Usuario.builder()
       .nombre("Mar√≠a Garc√≠a")
       .email("maria@example.com")
       .password("secreta123")
       .build()
   - Llama a UsuarioRepository

4. UsuarioRepository persiste en base de datos:
   - JpaRepository.save() ejecuta INSERT SQL
   - Hibernate genera: INSERT INTO usuarios (nombre, email, password) VALUES (...)
   - Si email ya existe ‚Üí ERROR 409 CONFLICT
   - Si OK ‚Üí Retorna Usuario con ID auto-generado

5. UsuarioService completa el proceso:
   - Convierte Entity a DTO con m√©todo factory:
     UsuarioResponseDTO.fromEntity(usuario)
   - ¬°IMPORTANTE! El password NO se incluye en el DTO de respuesta
   - @Transactional confirma transacci√≥n (COMMIT)

6. UsuarioController construye respuesta HTTP:
   - Envuelve DTO en ResponseEntity con status 201 CREATED
   - Spring Boot serializa DTO a JSON

7. Cliente recibe respuesta:
   HTTP/1.1 201 Created
   {
     "id": 1,
     "nombre": "Mar√≠a Garc√≠a",
     "email": "maria@example.com"
     // Nota: password NO incluido por seguridad
   }
```

### üí° ¬øQu√© aprender√°s usando este proyecto?

Al estudiar y experimentar con este c√≥digo, los estudiantes aprender√°n:

1. **C√≥mo estructurar** una aplicaci√≥n Spring Boot profesional
2. **Por qu√© separar** la aplicaci√≥n en capas (Controller, Service, Repository)
3. **Cu√°ndo usar** DTOs vs Entities
4. **C√≥mo validar** datos de entrada de forma declarativa
5. **Por qu√© usar** transacciones en operaciones de escritura
6. **C√≥mo manejar** errores de forma centralizada y elegante
7. **Qu√© c√≥digos HTTP** usar en cada situaci√≥n
8. **C√≥mo documentar** APIs con OpenAPI/Swagger
9. **Por qu√© es importante** la prevenci√≥n de race conditions
10. **C√≥mo integrar** un backend con frontends mediante CORS

### üöÄ Ideal para...

- ‚úÖ Estudiantes de ingenier√≠a en sistemas/inform√°tica
- ‚úÖ Desarrolladores aprendiendo Spring Boot por primera vez
- ‚úÖ Bootcamps y cursos de desarrollo backend
- ‚úÖ Proyectos acad√©micos de ejemplo
- ‚úÖ Referencia para arquitectura de microservicios
- ‚úÖ Base para proyectos m√°s complejos (a√±adiendo autenticaci√≥n, roles, etc.)

---

## Caracter√≠sticas Principales

### üéØ Funcionalidades Core

| Caracter√≠stica | Descripci√≥n |
|----------------|-------------|
| **CRUD Completo** | Operaciones Create, Read, Update, Delete totalmente funcionales |
| **Validaci√≥n Autom√°tica** | Jakarta Bean Validation con anotaciones (@NotBlank, @Email, @Size) |
| **C√≥digos HTTP Sem√°nticos** | Uso correcto de 200, 201, 204, 400, 409, 500 |
| **Manejo Global de Excepciones** | Respuestas de error estandarizadas mediante @ControllerAdvice |
| **Transacciones Expl√≠citas** | @Transactional en todas las operaciones de escritura |
| **Prevenci√≥n de Race Conditions** | Patr√≥n TOCTOU prevention con validaci√≥n at√≥mica |
| **Separaci√≥n DTO/Entity** | DTOs para API contracts, Entities para persistencia |
| **Seguridad de Datos** | Contrase√±as excluidas de respuestas JSON |

### üìö Caracter√≠sticas T√©cnicas

- **Base de Datos H2** en memoria con schema auto-generado
- **OpenAPI 3.0** con Swagger UI integrado
- **CORS configurado** para integraci√≥n con frontends (React, Angular, Vue)
- **Perfiles de Spring** (producci√≥n/desarrollo)
- **JAR ejecutable** standalone de 60MB
- **Lombok** para reducci√≥n de boilerplate
- **Java Records** para DTOs inmutables
- **Streams API** para programaci√≥n funcional

### üìñ Documentaci√≥n

- **JavaDoc exhaustivo** en espa√±ol (260+ l√≠neas por clase principal)
- **Swagger UI interactivo** para probar endpoints
- **README completo** con ejemplos de uso
- **CLAUDE.md** con arquitectura t√©cnica detallada

---

## Stack Tecnol√≥gico

### Tecnolog√≠as Core

| Tecnolog√≠a | Versi√≥n | Prop√≥sito | Documentaci√≥n |
|------------|---------|-----------|---------------|
| **Java** | 17 LTS | Lenguaje de programaci√≥n | [Oracle Docs](https://docs.oracle.com/en/java/javase/17/) |
| **Spring Boot** | 3.5.6 | Framework principal | [Spring Docs](https://spring.io/projects/spring-boot) |
| **Spring Data JPA** | 3.3.x | Capa de persistencia | [JPA Docs](https://spring.io/projects/spring-data-jpa) |
| **Hibernate** | 6.6.x | ORM (Object-Relational Mapping) | [Hibernate Docs](https://hibernate.org/) |
| **H2 Database** | 2.3.x | Base de datos en memoria | [H2 Docs](https://www.h2database.com/) |
| **Gradle** | 8.14 | Sistema de construcci√≥n | [Gradle Docs](https://docs.gradle.org/) |

### Librer√≠as Adicionales

| Librer√≠a | Versi√≥n | Prop√≥sito |
|----------|---------|-----------|
| **Spring Validation** | - | Validaciones con Jakarta Bean Validation |
| **Lombok** | - | Reducci√≥n de c√≥digo boilerplate |
| **SpringDoc OpenAPI** | 2.8.8 | Generaci√≥n autom√°tica de documentaci√≥n API |
| **JUnit 5** | - | Framework de testing |

### Anotaciones Principales Utilizadas

**Spring Framework:**
- `@SpringBootApplication` - Configuraci√≥n principal
- `@RestController` - Controlador REST
- `@Service` - Capa de servicio
- `@Repository` - Capa de acceso a datos
- `@Configuration` - Clases de configuraci√≥n
- `@Transactional` - Gesti√≥n de transacciones
- `@ControllerAdvice` - Manejo global de excepciones

**Jakarta Bean Validation:**
- `@Valid` - Activar validaci√≥n
- `@NotBlank` - Campo no vac√≠o
- `@Email` - Formato de email v√°lido
- `@Size` - Longitud m√≠nima/m√°xima

**Lombok:**
- `@Data` - Getters/setters/toString/equals/hashCode
- `@Builder` - Patr√≥n Builder
- `@RequiredArgsConstructor` - Constructor de dependencias
- `@AllArgsConstructor` / `@NoArgsConstructor` - Constructores

**JPA:**
- `@Entity` - Entidad de persistencia
- `@Table` - Mapeo de tabla
- `@Id` - Clave primaria
- `@GeneratedValue` - Generaci√≥n autom√°tica de ID
- `@Column` - Constraints de columna

---

## Requisitos Previos

### Software Necesario

1. **Java Development Kit (JDK) 17 o superior**
   ```bash
   # Verificar instalaci√≥n
   java -version
   # Debe mostrar: java version "17.x.x"
   ```

2. **Gradle 8.x** (incluido como wrapper en el proyecto)
   ```bash
   # No requiere instalaci√≥n manual, usar ./gradlew
   ./gradlew --version
   ```

3. **Sistema Operativo Compatible**
   - ‚úÖ Windows 10/11
   - ‚úÖ Linux (Ubuntu 20.04+, Fedora, etc.)
   - ‚úÖ macOS 11+

### Herramientas Recomendadas (Opcionales)

- **IDE:** IntelliJ IDEA, Eclipse, VS Code
- **Cliente API:** Postman, Insomnia, cURL
- **Navegador Web:** Chrome, Firefox, Edge (para Swagger UI)

---

## Instalaci√≥n R√°pida

### Paso 1: Clonar o Descargar el Proyecto

```bash
# Si tienes Git instalado
git clone <url-del-repositorio>
cd usuarios-en-memoria-api-documentada-main

# O simplemente descomprime el ZIP y navega al directorio
cd usuarios-en-memoria-api-documentada-main
```

### Paso 2: Verificar Requisitos

```bash
# Verificar Java
java -version

# Verificar Gradle Wrapper
./gradlew --version  # Linux/Mac
gradlew.bat --version  # Windows
```

### Paso 3: Compilar el Proyecto

```bash
# Linux/Mac
./gradlew build

# Windows
gradlew.bat build
```

### Paso 4: Ejecutar la Aplicaci√≥n

```bash
# Linux/Mac
./gradlew bootRun

# Windows
gradlew.bat bootRun
```

**¬°Listo!** La aplicaci√≥n estar√° corriendo en: **http://localhost:8080**

### Verificar que Funciona

```bash
# Probar el endpoint de listar usuarios
curl http://localhost:8080/api/usuarios

# Deber√≠a retornar: []
```

---

## Gu√≠a de Uso

### Ejecutar la Aplicaci√≥n

#### Modo Producci√≥n (sin logs SQL)

```bash
# Linux/Mac
./gradlew bootRun

# Windows
gradlew.bat bootRun
```

#### Modo Desarrollo (con logs SQL y consola H2)

```bash
# Linux/Mac
./gradlew bootRun --args='--spring.profiles.active=dev'

# Windows
gradlew.bat bootRun --args="--spring.profiles.active=dev"
```

#### Usando Variables de Entorno

```bash
# Linux/Mac
export JPA_SHOW_SQL=true
export H2_CONSOLE_ENABLED=true
./gradlew bootRun

# Windows (PowerShell)
$env:JPA_SHOW_SQL="true"
$env:H2_CONSOLE_ENABLED="true"
gradlew.bat bootRun

# Windows (CMD)
set JPA_SHOW_SQL=true
set H2_CONSOLE_ENABLED=true
gradlew.bat bootRun
```

### Compilar y Generar JAR

#### Compilar sin Tests

```bash
./gradlew build -x test
```

#### Compilar con Tests

```bash
./gradlew build
```

#### Generar JAR Ejecutable

```bash
./gradlew bootJar
```

El archivo JAR se genera en: **`build/libs/usuarios-api.jar`** (¬±60MB)

#### Ejecutar el JAR

```bash
# Modo producci√≥n
java -jar build/libs/usuarios-api.jar

# Modo desarrollo
java -jar build/libs/usuarios-api.jar --spring.profiles.active=dev

# Con variables de entorno
JPA_SHOW_SQL=true java -jar build/libs/usuarios-api.jar
```

### Ejecutar Tests

```bash
# Ejecutar todos los tests
./gradlew test

# Con salida detallada
./gradlew test --info

# Ver reporte HTML
# Ubicaci√≥n: build/reports/tests/test/index.html
```

### Generar Documentaci√≥n JavaDoc

```bash
# Generar JavaDoc HTML
./gradlew javadoc

# Ubicaci√≥n: build/docs/javadoc/index.html
```

Abrir en navegador:
```bash
# Linux
xdg-open build/docs/javadoc/index.html

# Mac
open build/docs/javadoc/index.html

# Windows
start build/docs/javadoc/index.html
```

### Limpiar Build

```bash
# Eliminar archivos compilados
./gradlew clean

# Limpiar y recompilar
./gradlew clean build
```

---

## Documentaci√≥n de la API

### URLs Importantes

| Recurso | URL | Descripci√≥n |
|---------|-----|-------------|
| **API Base** | http://localhost:8080/api/usuarios | Base path de la API |
| **Swagger UI** | http://localhost:8080/swagger-ui.html | Documentaci√≥n interactiva |
| **OpenAPI JSON** | http://localhost:8080/v3/api-docs | Especificaci√≥n OpenAPI |
| **H2 Console** | http://localhost:8080/h2-console | Consola BD (solo modo dev) |

### Endpoints Disponibles

#### Resumen de Endpoints

| M√©todo | Endpoint | Descripci√≥n | C√≥digo √âxito |
|--------|----------|-------------|--------------|
| **POST** | `/api/usuarios` | Crear nuevo usuario | 201 CREATED |
| **GET** | `/api/usuarios` | Listar todos los usuarios | 200 OK |
| **GET** | `/api/usuarios/{id}` | Obtener usuario por ID | 200 OK |
| **PUT** | `/api/usuarios/{id}` | Actualizar usuario | 200 OK |
| **DELETE** | `/api/usuarios/{id}` | Eliminar usuario | 204 NO CONTENT |

---

### 1Ô∏è‚É£ Crear Usuario

**Endpoint:** `POST /api/usuarios`

**Descripci√≥n:** Crea un nuevo usuario en el sistema con validaci√≥n autom√°tica de datos.

**Request Headers:**
```
Content-Type: application/json
```

**Request Body:**
```json
{
  "nombre": "Juan P√©rez",
  "email": "juan.perez@example.com",
  "password": "miPassword123"
}
```

**Validaciones Aplicadas:**

| Campo | Validaciones | Descripci√≥n |
|-------|-------------|-------------|
| `nombre` | @NotBlank, @Size(min=2, max=100) | Obligatorio, entre 2-100 caracteres |
| `email` | @NotBlank, @Email | Obligatorio, formato v√°lido |
| `password` | @NotBlank, @Size(min=6) | Obligatorio, m√≠nimo 6 caracteres |

**Respuesta Exitosa (201 CREATED):**
```json
{
  "id": 1,
  "nombre": "Juan P√©rez",
  "email": "juan.perez@example.com"
}
```

**Notas:**
- ‚úÖ El ID se genera autom√°ticamente
- ‚úÖ La contrase√±a NO se retorna en la respuesta (seguridad)
- ‚úÖ El email debe ser √∫nico en el sistema

**Errores Posibles:**

| C√≥digo | Descripci√≥n | Ejemplo |
|--------|-------------|---------|
| **400** | Validaci√≥n fallida | Email inv√°lido, nombre vac√≠o |
| **409** | Email ya existe | Conflicto de email duplicado |
| **500** | Error del servidor | Error inesperado |

**Ejemplo de Error (400 BAD REQUEST):**
```json
{
  "timestamp": "2025-10-31T14:30:00",
  "status": 400,
  "error": "Error de validaci√≥n",
  "detalles": [
    "nombre: El nombre no puede estar vac√≠o",
    "email: Formato de email inv√°lido",
    "password: La contrase√±a debe tener al menos 6 caracteres"
  ]
}
```

**Ejemplo de Error (409 CONFLICT):**
```json
{
  "timestamp": "2025-10-31T14:30:00",
  "status": 409,
  "error": "Error de integridad de datos",
  "detalles": [
    "El email ya est√° registrado"
  ]
}
```

---

### 2Ô∏è‚É£ Listar Todos los Usuarios

**Endpoint:** `GET /api/usuarios`

**Descripci√≥n:** Retorna la lista completa de usuarios registrados.

**Request Headers:** Ninguno requerido

**Respuesta Exitosa (200 OK):**
```json
[
  {
    "id": 1,
    "nombre": "Juan P√©rez",
    "email": "juan.perez@example.com"
  },
  {
    "id": 2,
    "nombre": "Mar√≠a Garc√≠a",
    "email": "maria.garcia@example.com"
  },
  {
    "id": 3,
    "nombre": "Carlos L√≥pez",
    "email": "carlos.lopez@example.com"
  }
]
```

**Respuesta cuando no hay usuarios:**
```json
[]
```

**Notas:**
- ‚úÖ Retorna un array vac√≠o si no hay usuarios (no error)
- ‚úÖ Las contrase√±as NUNCA se incluyen en las respuestas
- ‚úÖ Los usuarios se retornan en orden de inserci√≥n

**Errores Posibles:**

| C√≥digo | Descripci√≥n |
|--------|-------------|
| **500** | Error del servidor (muy raro) |

---

### 3Ô∏è‚É£ Obtener Usuario por ID

**Endpoint:** `GET /api/usuarios/{id}`

**Descripci√≥n:** Busca y retorna un usuario espec√≠fico por su identificador √∫nico.

**Par√°metros de Path:**
- `id` (Long): Identificador √∫nico del usuario

**Ejemplo de URL:** `GET /api/usuarios/1`

**Respuesta Exitosa (200 OK):**
```json
{
  "id": 1,
  "nombre": "Juan P√©rez",
  "email": "juan.perez@example.com"
}
```

**Errores Posibles:**

| C√≥digo | Descripci√≥n | Ejemplo |
|--------|-------------|---------|
| **400** | Usuario no encontrado | ID no existe en BD |
| **500** | Error del servidor | Error inesperado |

**Ejemplo de Error (400 BAD REQUEST):**
```json
{
  "timestamp": "2025-10-31T14:30:00",
  "status": 400,
  "error": "Argumento inv√°lido",
  "detalles": [
    "No existe un usuario con el ID 999"
  ]
}
```

---

### 4Ô∏è‚É£ Actualizar Usuario

**Endpoint:** `PUT /api/usuarios/{id}`

**Descripci√≥n:** Actualiza todos los campos de un usuario existente.

**Par√°metros de Path:**
- `id` (Long): Identificador del usuario a actualizar

**Request Headers:**
```
Content-Type: application/json
```

**Request Body:**
```json
{
  "nombre": "Juan P√©rez Actualizado",
  "email": "juan.nuevo@example.com",
  "password": "nuevaPassword456"
}
```

**Validaciones:** Las mismas que en crear usuario.

**Respuesta Exitosa (200 OK):**
```json
{
  "id": 1,
  "nombre": "Juan P√©rez Actualizado",
  "email": "juan.nuevo@example.com"
}
```

**Notas:**
- ‚úÖ Todos los campos son obligatorios (actualizaci√≥n completa)
- ‚úÖ El ID no se puede cambiar
- ‚úÖ La contrase√±a se puede actualizar
- ‚úÖ El nuevo email no debe estar en uso por otro usuario

**Errores Posibles:**

| C√≥digo | Descripci√≥n | Ejemplo |
|--------|-------------|---------|
| **400** | Usuario no encontrado o validaci√≥n fallida | ID inexistente, datos inv√°lidos |
| **409** | Email ya existe en otro usuario | Conflicto de email |
| **500** | Error del servidor | Error inesperado |

**Ejemplo de Error (409 CONFLICT):**
```json
{
  "timestamp": "2025-10-31T14:30:00",
  "status": 409,
  "error": "Error de integridad de datos",
  "detalles": [
    "El email ya est√° registrado"
  ]
}
```

---

### 5Ô∏è‚É£ Eliminar Usuario

**Endpoint:** `DELETE /api/usuarios/{id}`

**Descripci√≥n:** Elimina permanentemente un usuario del sistema.

**Par√°metros de Path:**
- `id` (Long): Identificador del usuario a eliminar

**Respuesta Exitosa (204 NO CONTENT):**
```
(Sin contenido en el body)
```

**Notas:**
- ‚úÖ Retorna 204 sin contenido si es exitoso
- ‚úÖ La eliminaci√≥n es permanente (no hay papelera)
- ‚úÖ Valida que el usuario exista antes de eliminar

**Errores Posibles:**

| C√≥digo | Descripci√≥n | Ejemplo |
|--------|-------------|---------|
| **400** | Usuario no encontrado | ID no existe |
| **500** | Error del servidor | Error inesperado |

**Ejemplo de Error (400 BAD REQUEST):**
```json
{
  "timestamp": "2025-10-31T14:30:00",
  "status": 400,
  "error": "Argumento inv√°lido",
  "detalles": [
    "No existe un usuario con el ID 999"
  ]
}
```

---

## Ejemplos de Peticiones

### Con cURL

#### Crear Usuario
```bash
curl -X POST http://localhost:8080/api/usuarios \
  -H "Content-Type: application/json" \
  -d '{
    "nombre": "Ana L√≥pez",
    "email": "ana.lopez@example.com",
    "password": "password123"
  }'
```

#### Listar Usuarios
```bash
curl http://localhost:8080/api/usuarios
```

#### Obtener Usuario por ID
```bash
curl http://localhost:8080/api/usuarios/1
```

#### Actualizar Usuario
```bash
curl -X PUT http://localhost:8080/api/usuarios/1 \
  -H "Content-Type: application/json" \
  -d '{
    "nombre": "Ana L√≥pez Actualizada",
    "email": "ana.nueva@example.com",
    "password": "newpass456"
  }'
```

#### Eliminar Usuario
```bash
curl -X DELETE http://localhost:8080/api/usuarios/1
```

### Con JavaScript (Fetch API)

#### Crear Usuario
```javascript
const crearUsuario = async () => {
  const response = await fetch('http://localhost:8080/api/usuarios', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      nombre: 'Carlos Ruiz',
      email: 'carlos.ruiz@example.com',
      password: 'password123'
    })
  });

  if (response.status === 201) {
    const usuario = await response.json();
    console.log('Usuario creado:', usuario);
  } else {
    const error = await response.json();
    console.error('Error:', error);
  }
};
```

#### Listar Usuarios
```javascript
const listarUsuarios = async () => {
  const response = await fetch('http://localhost:8080/api/usuarios');
  const usuarios = await response.json();
  console.log('Usuarios:', usuarios);
};
```

#### Actualizar Usuario
```javascript
const actualizarUsuario = async (id) => {
  const response = await fetch(`http://localhost:8080/api/usuarios/${id}`, {
    method: 'PUT',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      nombre: 'Nuevo Nombre',
      email: 'nuevo.email@example.com',
      password: 'newpass123'
    })
  });

  if (response.ok) {
    const usuario = await response.json();
    console.log('Usuario actualizado:', usuario);
  }
};
```

#### Eliminar Usuario
```javascript
const eliminarUsuario = async (id) => {
  const response = await fetch(`http://localhost:8080/api/usuarios/${id}`, {
    method: 'DELETE'
  });

  if (response.status === 204) {
    console.log('Usuario eliminado exitosamente');
  }
};
```

### Con Axios (React/Vue/Angular)

```javascript
import axios from 'axios';

const api = axios.create({
  baseURL: 'http://localhost:8080/api',
  headers: {
    'Content-Type': 'application/json'
  }
});

// Crear usuario
const crearUsuario = async () => {
  try {
    const response = await api.post('/usuarios', {
      nombre: 'Pedro Mart√≠nez',
      email: 'pedro.martinez@example.com',
      password: 'pass123456'
    });
    console.log('Usuario creado:', response.data);
  } catch (error) {
    console.error('Error:', error.response.data);
  }
};

// Listar usuarios
const listarUsuarios = async () => {
  const response = await api.get('/usuarios');
  console.log('Usuarios:', response.data);
};

// Actualizar usuario
const actualizarUsuario = async (id) => {
  const response = await api.put(`/usuarios/${id}`, {
    nombre: 'Pedro Actualizado',
    email: 'pedro.nuevo@example.com',
    password: 'newpass789'
  });
  console.log('Usuario actualizado:', response.data);
};

// Eliminar usuario
const eliminarUsuario = async (id) => {
  await api.delete(`/usuarios/${id}`);
  console.log('Usuario eliminado');
};
```

---

## Arquitectura T√©cnica

### Patr√≥n de Tres Capas

La aplicaci√≥n sigue el patr√≥n arquitect√≥nico de **tres capas** (Three-Tier Architecture) que separa las responsabilidades en:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     CAPA 1: PRESENTACI√ìN                 ‚îÇ
‚îÇ                    (Controller Layer)                    ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  üìç Responsabilidades:                                   ‚îÇ
‚îÇ    ‚Ä¢ Exponer endpoints REST                             ‚îÇ
‚îÇ    ‚Ä¢ Validar request bodies con @Valid                  ‚îÇ
‚îÇ    ‚Ä¢ Mapear HTTP requests/responses                     ‚îÇ
‚îÇ    ‚Ä¢ Retornar c√≥digos HTTP sem√°nticos                   ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  üìÇ Ubicaci√≥n: controller/UsuarioController.java        ‚îÇ
‚îÇ  üîß Anotaciones: @RestController, @RequestMapping       ‚îÇ
‚îÇ                                                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
                       ‚Üì @Autowired (inyecci√≥n)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   CAPA 2: L√ìGICA DE NEGOCIO             ‚îÇ
‚îÇ                     (Service Layer)                      ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  üìç Responsabilidades:                                   ‚îÇ
‚îÇ    ‚Ä¢ Implementar reglas de negocio                      ‚îÇ
‚îÇ    ‚Ä¢ Gestionar transacciones con @Transactional         ‚îÇ
‚îÇ    ‚Ä¢ Validar existencia de entidades                    ‚îÇ
‚îÇ    ‚Ä¢ Convertir entre DTOs y Entities                    ‚îÇ
‚îÇ    ‚Ä¢ Prevenir race conditions                           ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  üìÇ Ubicaci√≥n: service/UsuarioService.java              ‚îÇ
‚îÇ  üîß Anotaciones: @Service, @Transactional               ‚îÇ
‚îÇ                                                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
                       ‚Üì @Autowired (inyecci√≥n)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  CAPA 3: ACCESO A DATOS                 ‚îÇ
‚îÇ                   (Repository Layer)                     ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  üìç Responsabilidades:                                   ‚îÇ
‚îÇ    ‚Ä¢ Abstraer operaciones CRUD                          ‚îÇ
‚îÇ    ‚Ä¢ Interactuar con la base de datos                   ‚îÇ
‚îÇ    ‚Ä¢ Ejecutar queries JPA/SQL                           ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  üìÇ Ubicaci√≥n: repository/UsuarioRepository.java        ‚îÇ
‚îÇ  üîß Anotaciones: @Repository                            ‚îÇ
‚îÇ  üîó Extiende: JpaRepository<Usuario, Long>              ‚îÇ
‚îÇ                                                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îÇ
                       ‚Üì JPA/Hibernate
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    BASE DE DATOS H2                      ‚îÇ
‚îÇ                   (In-Memory Database)                   ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  üóÑÔ∏è jdbc:h2:mem:usuariosdb                              ‚îÇ
‚îÇ  üìä Tabla: usuarios                                      ‚îÇ
‚îÇ  üîë Constraints: UNIQUE(email), NOT NULL                ‚îÇ
‚îÇ                                                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Flujo de Datos Completo

#### Ejemplo: Crear Usuario

```
1. üåê Cliente HTTP
   ‚Üì
   POST /api/usuarios
   { "nombre": "Juan", "email": "juan@example.com", "password": "pass123" }
   ‚Üì
2. üéÆ UsuarioController
   ‚Üì
   @Valid activa validaciones (@NotBlank, @Email, @Size)
   ‚Üì
   Si validaci√≥n OK ‚Üí Convierte JSON a UsuarioRequestDTO
   Si validaci√≥n FALLA ‚Üí Lanza MethodArgumentNotValidException (400)
   ‚Üì
3. üîß UsuarioService.crearUsuario(dto)
   ‚Üì
   @Transactional inicia transacci√≥n
   ‚Üì
   Convierte DTO a Entity usando Builder:
   Usuario.builder()
       .nombre(dto.nombre())
       .email(dto.email())
       .password(dto.password())
       .build()
   ‚Üì
4. üíæ UsuarioRepository.save(usuario)
   ‚Üì
   Hibernate ejecuta: INSERT INTO usuarios (nombre, email, password) VALUES (...)
   ‚Üì
   Si email duplicado ‚Üí Lanza DataIntegrityViolationException (409)
   Si OK ‚Üí Retorna Usuario con ID generado
   ‚Üì
5. üîÑ UsuarioService
   ‚Üì
   Convierte Entity a DTO:
   UsuarioResponseDTO.fromEntity(usuario)
   ‚Üì
   @Transactional confirma transacci√≥n (commit)
   ‚Üì
6. üì§ UsuarioController
   ‚Üì
   Envuelve en ResponseEntity<>:
   ResponseEntity.status(HttpStatus.CREATED).body(dto)
   ‚Üì
7. üåê Cliente HTTP recibe:
   HTTP/1.1 201 Created
   { "id": 1, "nombre": "Juan", "email": "juan@example.com" }
```

### Patr√≥n DTO (Data Transfer Object)

La aplicaci√≥n utiliza **DTOs** para separar la representaci√≥n interna (Entity) de la representaci√≥n externa (API):

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    UsuarioRequestDTO                     ‚îÇ
‚îÇ                    (Input - Validado)                    ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  ‚Ä¢ nombre: String (2-100 chars, no vac√≠o)               ‚îÇ
‚îÇ  ‚Ä¢ email: String (formato v√°lido, no vac√≠o)             ‚îÇ
‚îÇ  ‚Ä¢ password: String (min 6 chars, no vac√≠o)             ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  ‚úÖ Incluye anotaciones de validaci√≥n                   ‚îÇ
‚îÇ  ‚úÖ Java Record (inmutable)                             ‚îÇ
‚îÇ  ‚úÖ Usado en POST y PUT                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚Üì
                  Conversi√≥n manual en Service
                            ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        Usuario                           ‚îÇ
‚îÇ                    (Entity - JPA)                        ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  ‚Ä¢ id: Long (auto-generado)                             ‚îÇ
‚îÇ  ‚Ä¢ nombre: String                                       ‚îÇ
‚îÇ  ‚Ä¢ email: String (UNIQUE constraint)                    ‚îÇ
‚îÇ  ‚Ä¢ password: String                                     ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  ‚úÖ Anotaciones JPA (@Entity, @Table, @Column)          ‚îÇ
‚îÇ  ‚úÖ Lombok @Data, @Builder                              ‚îÇ
‚îÇ  ‚úÖ Usado internamente en Service/Repository            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚Üì
            Conversi√≥n con fromEntity() static factory
                            ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   UsuarioResponseDTO                     ‚îÇ
‚îÇ                   (Output - Seguro)                      ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  ‚Ä¢ id: Long                                             ‚îÇ
‚îÇ  ‚Ä¢ nombre: String                                       ‚îÇ
‚îÇ  ‚Ä¢ email: String                                        ‚îÇ
‚îÇ                                                          ‚îÇ
‚îÇ  ‚ùå NO incluye password (seguridad)                     ‚îÇ
‚îÇ  ‚úÖ Java Record (inmutable)                             ‚îÇ
‚îÇ  ‚úÖ Retornado en todas las respuestas                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**¬øPor qu√© usar DTOs?**
- üîí **Seguridad:** Excluir campos sensibles (password) de respuestas
- üîÑ **Flexibilidad:** Cambiar Entity sin afectar API contract
- ‚úÖ **Validaci√≥n:** Aplicar validaciones espec√≠ficas en input
- üìù **Documentaci√≥n:** API clara y predecible

### Modelo de Dominio

#### Entidad Usuario

```java
@Entity
@Table(name = "usuarios")
@Data
@Builder
@AllArgsConstructor
@NoArgsConstructor
public class Usuario {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(nullable = false, length = 100)
    private String nombre;

    @Column(nullable = false, unique = true, length = 255)
    private String email;

    @Column(nullable = false, length = 255)
    private String password;
}
```

#### Tabla en Base de Datos

```sql
CREATE TABLE usuarios (
    id       BIGINT         NOT NULL AUTO_INCREMENT PRIMARY KEY,
    nombre   VARCHAR(100)   NOT NULL,
    email    VARCHAR(255)   NOT NULL UNIQUE,
    password VARCHAR(255)   NOT NULL
);
```

#### Constraints de Integridad

| Constraint | Tipo | Aplicado a | Prop√≥sito |
|------------|------|------------|-----------|
| **PRIMARY KEY** | PK | `id` | Identificador √∫nico |
| **AUTO_INCREMENT** | Sequence | `id` | Generaci√≥n autom√°tica |
| **NOT NULL** | Check | Todos | Campos obligatorios |
| **UNIQUE** | Index | `email` | Un email por usuario |
| **LENGTH** | Check | Todos | L√≠mites de caracteres |

### Gesti√≥n de Transacciones

#### M√©todos Transaccionales

```java
@Service
public class UsuarioService {

    // ‚úÖ @Transactional en TODAS las operaciones de escritura

    @Transactional
    public UsuarioResponseDTO crearUsuario(UsuarioRequestDTO dto) {
        // Garantiza atomicidad: build + save + toDTO
    }

    @Transactional
    public UsuarioResponseDTO actualizarUsuario(Long id, UsuarioRequestDTO dto) {
        // Garantiza atomicidad: find + modify + save
    }

    @Transactional
    public void eliminarUsuario(Long id) {
        // Previene TOCTOU: find + delete at√≥mico
    }

    // ‚ùå listarUsuarios() y buscarUsuario() NO tienen @Transactional
    // (solo lectura, no necesitan transacci√≥n expl√≠cita)
}
```

#### Prevenci√≥n de Race Conditions (TOCTOU)

**Problema:**
```java
// ‚ùå INCORRECTO: Race condition
if (repository.existsById(id)) {
    // Otro thread podr√≠a eliminar el usuario aqu√≠
    repository.deleteById(id);  // Falla silenciosamente
}
```

**Soluci√≥n:**
```java
// ‚úÖ CORRECTO: Validaci√≥n at√≥mica con @Transactional
@Transactional
public void eliminarUsuario(Long id) {
    Usuario usuario = repository.findById(id)
        .orElseThrow(() -> new IllegalArgumentException("No existe usuario"));
    repository.delete(usuario);  // Usa la misma instancia obtenida
}
```

---

## Configuraci√≥n CORS

La aplicaci√≥n incluye configuraci√≥n **CORS (Cross-Origin Resource Sharing)** para permitir peticiones desde aplicaciones frontend en diferentes or√≠genes.

### ¬øQu√© es CORS?

CORS es un mecanismo de seguridad del navegador que restringe peticiones HTTP entre diferentes or√≠genes (dominio, puerto o protocolo). Sin CORS, un frontend en `http://localhost:3000` no podr√≠a consumir una API en `http://localhost:8080`.

### Configuraci√≥n Actual

**Archivo:** `src/main/java/org/jcr/usuariosenmemoria/config/WebConfig.java`

```java
@Configuration
public class WebConfig implements WebMvcConfigurer {
    @Override
    public void addCorsMappings(CorsRegistry registry) {
        registry.addMapping("/api/**")
                .allowedOrigins(
                    "http://localhost:3000",    // React/Vue/Next.js
                    "http://localhost:4200",    // Angular
                    "https://miapp.com"         // Producci√≥n
                )
                .allowedMethods("GET", "POST", "PUT", "DELETE", "OPTIONS")
                .allowedHeaders("*")
                .allowCredentials(true)
                .maxAge(3600);
    }
}
```

### Or√≠genes Permitidos

| Origen | Framework | Prop√≥sito |
|--------|-----------|-----------|
| `http://localhost:3000` | React, Vue, Next.js | Servidor de desarrollo |
| `http://localhost:4200` | Angular | Angular CLI dev server |
| `https://miapp.com` | Cualquiera | Producci√≥n (CAMBIAR) |

### ‚ö†Ô∏è Importante para Producci√≥n

Antes de desplegar a producci√≥n:
1. Reemplazar `https://miapp.com` con tu dominio real
2. Eliminar or√≠genes de desarrollo (localhost)
3. Usar dominios espec√≠ficos (NO wildcards)

### Probar CORS desde Frontend

```javascript
// React/Vue/Angular en localhost:3000
fetch('http://localhost:8080/api/usuarios', {
    method: 'POST',
    credentials: 'include',  // Incluir cookies si es necesario
    headers: {
        'Content-Type': 'application/json'
    },
    body: JSON.stringify({
        nombre: 'Test',
        email: 'test@example.com',
        password: 'pass123'
    })
})
.then(response => response.json())
.then(data => console.log(data));
```

---

## Manejo de Errores

### Estructura de Respuesta de Error

Todos los errores retornan un objeto estandarizado:

```json
{
  "timestamp": "2025-10-31T14:30:00",
  "status": 400,
  "error": "Descripci√≥n del tipo de error",
  "detalles": [
    "Mensaje espec√≠fico 1",
    "Mensaje espec√≠fico 2"
  ]
}
```

### C√≥digos HTTP Utilizados

| C√≥digo | Nombre | Descripci√≥n | Cu√°ndo se usa |
|--------|--------|-------------|---------------|
| **200** | OK | Petici√≥n exitosa | GET, PUT exitosos |
| **201** | CREATED | Recurso creado | POST exitoso |
| **204** | NO CONTENT | Sin contenido | DELETE exitoso |
| **400** | BAD REQUEST | Petici√≥n inv√°lida | Validaci√≥n fallida, ID inexistente |
| **409** | CONFLICT | Conflicto de datos | Email duplicado |
| **500** | INTERNAL ERROR | Error del servidor | Error inesperado |

### Excepciones Capturadas

#### 1. MethodArgumentNotValidException (400)

**Causa:** Fall√≥ la validaci√≥n de Bean Validation (@NotBlank, @Email, @Size)

**Ejemplo de Respuesta:**
```json
{
  "timestamp": "2025-10-31T14:30:00",
  "status": 400,
  "error": "Error de validaci√≥n",
  "detalles": [
    "nombre: El nombre no puede estar vac√≠o",
    "email: Formato de email inv√°lido",
    "password: La contrase√±a debe tener al menos 6 caracteres"
  ]
}
```

#### 2. IllegalArgumentException (400)

**Causa:** Usuario no encontrado (ID inexistente)

**Ejemplo de Respuesta:**
```json
{
  "timestamp": "2025-10-31T14:30:00",
  "status": 400,
  "error": "Argumento inv√°lido",
  "detalles": [
    "No existe un usuario con el ID 999"
  ]
}
```

#### 3. DataIntegrityViolationException (409)

**Causa:** Violaci√≥n de constraint UNIQUE (email duplicado)

**Ejemplo de Respuesta:**
```json
{
  "timestamp": "2025-10-31T14:30:00",
  "status": 409,
  "error": "Error de integridad de datos",
  "detalles": [
    "El email ya est√° registrado"
  ]
}
```

#### 4. Exception Gen√©rica (500)

**Causa:** Error inesperado del servidor

**Ejemplo de Respuesta:**
```json
{
  "timestamp": "2025-10-31T14:30:00",
  "status": 500,
  "error": "Error interno del servidor",
  "detalles": [
    "Ha ocurrido un error inesperado. Por favor, contacte al administrador."
  ]
}
```

### GlobalExceptionHandler

**Ubicaci√≥n:** `src/main/java/org/jcr/usuariosenmemoria/exception/GlobalExceptionHandler.java`

```java
@ControllerAdvice
public class GlobalExceptionHandler {

    // Captura errores de validaci√≥n Bean Validation
    @ExceptionHandler(MethodArgumentNotValidException.class)
    public ResponseEntity<ErrorDTO> handleValidationErrors(...)

    // Captura errores de ID no encontrado
    @ExceptionHandler(IllegalArgumentException.class)
    public ResponseEntity<ErrorDTO> handleIllegalArgument(...)

    // Captura errores de email duplicado
    @ExceptionHandler(DataIntegrityViolationException.class)
    public ResponseEntity<ErrorDTO> handleDataIntegrityViolation(...)

    // Captura cualquier error no manejado
    @ExceptionHandler(Exception.class)
    public ResponseEntity<ErrorDTO> handleGenericException(...)
}
```

**Ventajas:**
- ‚úÖ Centralizado en una sola clase
- ‚úÖ Respuestas estandarizadas
- ‚úÖ No expone stack traces
- ‚úÖ Mensajes en espa√±ol

---

## Base de Datos

### H2 In-Memory Database

La aplicaci√≥n usa **H2**, una base de datos relacional en memoria escrita en Java.

#### Caracter√≠sticas

| Caracter√≠stica | Valor |
|----------------|-------|
| **Tipo** | In-Memory (datos se pierden al cerrar) |
| **Modo** | Embedded (incluida en el JAR) |
| **URL JDBC** | `jdbc:h2:mem:usuariosdb` |
| **Usuario** | `sa` |
| **Contrase√±a** | (vac√≠a) |
| **Schema** | Auto-generado por JPA |
| **Consola Web** | Habilitada en modo dev |

#### Acceder a la Consola H2

1. **Ejecutar en modo desarrollo:**
   ```bash
   ./gradlew bootRun --args='--spring.profiles.active=dev'
   ```

2. **Abrir navegador en:** http://localhost:8080/h2-console

3. **Configurar conexi√≥n:**
   ```
   Driver Class: org.h2.Driver
   JDBC URL: jdbc:h2:mem:usuariosdb
   User Name: sa
   Password: (dejar vac√≠o)
   ```

4. **Clic en "Connect"**

5. **Ejecutar queries SQL:**
   ```sql
   -- Ver todos los usuarios
   SELECT * FROM usuarios;

   -- Buscar por email
   SELECT * FROM usuarios WHERE email = 'juan@example.com';

   -- Contar usuarios
   SELECT COUNT(*) FROM usuarios;

   -- Insertar usuario manualmente
   INSERT INTO usuarios (nombre, email, password)
   VALUES ('Test', 'test@example.com', 'pass123');
   ```

### Schema de Base de Datos

```sql
CREATE TABLE usuarios (
    id       BIGINT         NOT NULL AUTO_INCREMENT PRIMARY KEY,
    nombre   VARCHAR(100)   NOT NULL,
    email    VARCHAR(255)   NOT NULL UNIQUE,
    password VARCHAR(255)   NOT NULL
);

-- √çndice autom√°tico en email por constraint UNIQUE
CREATE UNIQUE INDEX IF NOT EXISTS UK_email ON usuarios(email);
```

### Configuraci√≥n JPA

**Archivo:** `src/main/resources/application.properties`

```properties
# Datasource H2
spring.datasource.url=jdbc:h2:mem:usuariosdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=

# Hibernate
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=${JPA_SHOW_SQL:false}
spring.jpa.properties.hibernate.format_sql=true

# Consola H2
spring.h2.console.enabled=${H2_CONSOLE_ENABLED:false}
spring.h2.console.path=/h2-console
```

**Modos DDL:**
- `update`: Actualiza schema sin borrar datos
- `create`: Crea schema desde cero (borra datos)
- `validate`: Solo valida (no modifica)
- `none`: No hace nada

### Perfiles de Configuraci√≥n

#### Perfil: default (Producci√≥n)

- ‚ùå Logs SQL deshabilitados
- ‚ùå Consola H2 deshabilitada
- ‚úÖ Modo seguro

#### Perfil: dev (Desarrollo)

**Archivo:** `src/main/resources/application-dev.properties`

```properties
JPA_SHOW_SQL=true
H2_CONSOLE_ENABLED=true
```

- ‚úÖ Logs SQL habilitados
- ‚úÖ Consola H2 habilitada
- üîç Ver queries ejecutadas

---

## Consideraciones de Seguridad

### ‚ö†Ô∏è Advertencia Importante

**Esta es una aplicaci√≥n de demostraci√≥n educativa. NO est√° lista para producci√≥n.**

### Limitaciones Actuales

| Limitaci√≥n | Impacto | Soluci√≥n Recomendada |
|------------|---------|----------------------|
| **Contrase√±as en texto plano** | üî¥ CR√çTICO | BCrypt/Argon2 con Spring Security |
| **Sin autenticaci√≥n** | üî¥ CR√çTICO | JWT o Spring Security Basic Auth |
| **Sin autorizaci√≥n** | üî¥ CR√çTICO | Roles y permisos con Spring Security |
| **Sin HTTPS** | üü° ALTO | Certificado SSL/TLS |
| **CORS permisivo** | üü° ALTO | Restringir a dominios espec√≠ficos |
| **Sin rate limiting** | üü° MEDIO | Bucket4j o Spring Cloud Gateway |
| **BD en memoria** | üü° MEDIO | PostgreSQL, MySQL, MongoDB |
| **Sin audit logging** | üü° MEDIO | Spring Data Envers o AOP |

### Recomendaciones para Producci√≥n

#### 1. Cifrado de Contrase√±as

```java
// Agregar dependencia
implementation 'org.springframework.boot:spring-boot-starter-security'

// Configurar BCrypt
@Configuration
public class SecurityConfig {
    @Bean
    public PasswordEncoder passwordEncoder() {
        return new BCryptPasswordEncoder();
    }
}

// En UsuarioService
@Autowired
private PasswordEncoder passwordEncoder;

public Usuario crearUsuario(UsuarioRequestDTO dto) {
    Usuario usuario = Usuario.builder()
        .nombre(dto.nombre())
        .email(dto.email())
        .password(passwordEncoder.encode(dto.password()))  // Cifrar
        .build();
    return repository.save(usuario);
}
```

#### 2. Autenticaci√≥n con JWT

```java
// Agregar dependencias
implementation 'io.jsonwebtoken:jjwt-api:0.11.5'
implementation 'io.jsonwebtoken:jjwt-impl:0.11.5'
implementation 'io.jsonwebtoken:jjwt-jackson:0.11.5'

// Implementar JwtTokenProvider
// Implementar UserDetailsService
// Configurar SecurityFilterChain
```

#### 3. Base de Datos Persistente

```yaml
# application.yml con PostgreSQL
spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/usuariosdb
    username: ${DB_USER}
    password: ${DB_PASSWORD}
  jpa:
    hibernate:
      ddl-auto: validate  # Usar migrations en producci√≥n
```

#### 4. Variables de Entorno

```bash
# NO hardcodear credenciales
export DB_USER=admin
export DB_PASSWORD=secretpassword
export JWT_SECRET=my-super-secret-key
```

#### 5. CORS Restrictivo

```java
registry.addMapping("/api/**")
    .allowedOrigins("https://miapp.com")  // Solo dominio real
    .allowedMethods("GET", "POST", "PUT", "DELETE")
    .allowedHeaders("Authorization", "Content-Type")
    .allowCredentials(false);  // Deshabilitar si no se usan cookies
```

---

## Documentaci√≥n Adicional

### JavaDoc

La aplicaci√≥n incluye **documentaci√≥n JavaDoc exhaustiva en espa√±ol** con m√°s de 2000 l√≠neas de comentarios explicativos.

**Generar HTML:**
```bash
./gradlew javadoc
```

**Abrir:** `build/docs/javadoc/index.html`

**Contenido:**
- Explicaciones arquitect√≥nicas
- Patrones de dise√±o
- Conceptos de Spring Framework
- Gesti√≥n de transacciones
- Prevenci√≥n de race conditions
- API funcional de Java

### Swagger UI

**URL:** http://localhost:8080/swagger-ui.html

**Caracter√≠sticas:**
- üìñ Documentaci√≥n interactiva
- üß™ Probar endpoints desde el navegador
- üìù Ver esquemas de DTOs
- üîç C√≥digos de respuesta documentados
- üíæ Guardar configuraciones

### Archivos de Referencia

| Archivo | Prop√≥sito |
|---------|-----------|
| **CLAUDE.md** | Arquitectura t√©cnica para desarrolladores |
| **README.md** | Este archivo |
| **build.gradle** | Configuraci√≥n de dependencias |
| **application.properties** | Configuraci√≥n de Spring Boot |

---

## Estructura del Proyecto

```
usuarios-en-memoria-api-documentada-main/
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ java/org/jcr/usuariosenmemoria/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config/                         # Configuraci√≥n
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ OpenApiConfig.java         # Swagger/OpenAPI
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ WebConfig.java             # CORS
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controller/                     # Capa de Presentaci√≥n
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UsuarioController.java     # REST endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dto/                            # Data Transfer Objects
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ErrorDTO.java              # Respuesta de error
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UsuarioRequestDTO.java     # Input DTO
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UsuarioResponseDTO.java    # Output DTO
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ exception/                      # Manejo de Excepciones
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ GlobalExceptionHandler.java
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ model/                          # Entidades JPA
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Usuario.java               # Entity Usuario
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ repository/                     # Capa de Datos
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UsuarioRepository.java     # JPA Repository
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ service/                        # Capa de Negocio
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UsuarioService.java        # Business logic
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UsuariosEnMemoriaApplication.java  # Main class
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ resources/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ application.properties          # Config producci√≥n
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ application-dev.properties      # Config desarrollo
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ test/                                   # Tests
‚îÇ       ‚îî‚îÄ‚îÄ java/org/jcr/usuariosenmemoria/
‚îÇ           ‚îî‚îÄ‚îÄ UsuariosEnMemoriaApplicationTests.java
‚îÇ
‚îú‚îÄ‚îÄ gradle/                                     # Gradle Wrapper
‚îÇ   ‚îî‚îÄ‚îÄ wrapper/
‚îÇ       ‚îú‚îÄ‚îÄ gradle-wrapper.jar
‚îÇ       ‚îî‚îÄ‚îÄ gradle-wrapper.properties
‚îÇ
‚îú‚îÄ‚îÄ build/                                      # Archivos compilados
‚îÇ   ‚îú‚îÄ‚îÄ classes/                                # .class files
‚îÇ   ‚îú‚îÄ‚îÄ docs/javadoc/                          # JavaDoc HTML
‚îÇ   ‚îú‚îÄ‚îÄ libs/usuarios-api.jar                  # JAR ejecutable
‚îÇ   ‚îî‚îÄ‚îÄ reports/                                # Reportes de tests
‚îÇ
‚îú‚îÄ‚îÄ build.gradle                                # Configuraci√≥n Gradle
‚îú‚îÄ‚îÄ settings.gradle                             # Configuraci√≥n proyecto
‚îú‚îÄ‚îÄ gradlew                                     # Gradle wrapper (Linux/Mac)
‚îú‚îÄ‚îÄ gradlew.bat                                 # Gradle wrapper (Windows)
‚îÇ
‚îú‚îÄ‚îÄ CLAUDE.md                                   # Documentaci√≥n t√©cnica
‚îî‚îÄ‚îÄ README.md                                   # Este archivo
```

---

## Comandos R√°pidos

### Desarrollo

```bash
# Ejecutar aplicaci√≥n (modo desarrollo)
./gradlew bootRun --args='--spring.profiles.active=dev'

# Compilar sin ejecutar tests
./gradlew build -x test

# Ejecutar tests con reporte
./gradlew test

# Generar JavaDoc
./gradlew javadoc

# Limpiar y recompilar
./gradlew clean build
```

### Producci√≥n

```bash
# Generar JAR
./gradlew bootJar

# Ejecutar JAR
java -jar build/libs/usuarios-api.jar

# Con profile dev
java -jar build/libs/usuarios-api.jar --spring.profiles.active=dev
```

### Verificaci√≥n

```bash
# Probar aplicaci√≥n
curl http://localhost:8080/api/usuarios

# Ver Swagger UI
open http://localhost:8080/swagger-ui.html

# Ver consola H2 (modo dev)
open http://localhost:8080/h2-console
```

---

## Troubleshooting

### Error: "Port 8080 is already in use"

**Soluci√≥n:**
```bash
# Linux/Mac
lsof -ti:8080 | xargs kill -9

# Windows (PowerShell)
Get-Process -Id (Get-NetTCPConnection -LocalPort 8080).OwningProcess | Stop-Process

# O cambiar el puerto
./gradlew bootRun --args='--server.port=8081'
```

### Error: "Java version not compatible"

**Soluci√≥n:**
```bash
# Verificar versi√≥n instalada
java -version

# Debe ser Java 17 o superior
# Descargar desde: https://adoptium.net/
```

### Error: "Gradle not found"

**Soluci√≥n:**
```bash
# Usar el wrapper incluido
./gradlew --version  # Linux/Mac
gradlew.bat --version  # Windows
```

### H2 Console no accesible

**Soluci√≥n:**
```bash
# Verificar que est√© en modo dev
./gradlew bootRun --args='--spring.profiles.active=dev'

# O habilitar variable
export H2_CONSOLE_ENABLED=true
./gradlew bootRun
```

### CORS Error desde Frontend

**Soluci√≥n:**
1. Verificar que el origen est√° en `WebConfig.java`
2. Verificar que el navegador no cachea OPTIONS
3. Probar desde Swagger UI primero

---

## Preguntas Frecuentes (FAQ)

### ¬øPuedo usar esta API en producci√≥n?

‚ùå **NO.** Esta es una aplicaci√≥n educativa con limitaciones de seguridad:
- Contrase√±as sin cifrar
- Sin autenticaci√≥n
- Base de datos en memoria
- Sin rate limiting

### ¬øC√≥mo agrego m√°s campos al Usuario?

1. Modificar `Usuario.java` (agregar campo con `@Column`)
2. Modificar `UsuarioRequestDTO.java` (agregar validaciones)
3. Modificar `UsuarioResponseDTO.java` (agregar campo)
4. Actualizar conversiones en `UsuarioService.java`
5. Regenerar JavaDoc

### ¬øC√≥mo cambio el puerto?

```bash
# Temporal
./gradlew bootRun --args='--server.port=9090'

# Permanente: editar application.properties
server.port=9090
```

### ¬øC√≥mo persisten los datos?

‚ùå **No persisten.** H2 est√° en modo `mem:` (memoria).

Para persistir datos:
1. Cambiar a H2 file-based: `jdbc:h2:file:./data/usuariosdb`
2. O migrar a PostgreSQL/MySQL

### ¬øPuedo usar PostgreSQL en lugar de H2?

‚úÖ **S√≠.** Modificar `build.gradle` y `application.properties`:

```gradle
// build.gradle
runtimeOnly 'org.postgresql:postgresql'
```

```properties
# application.properties
spring.datasource.url=jdbc:postgresql://localhost:5432/usuariosdb
spring.datasource.username=postgres
spring.datasource.password=password
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
```

---

## Autor

**Juan Cruz Robledo**

- üìß Email: juan.robledo@tuinstituto.edu.ar
- üåê Web: https://juancruz.edu.ar
- üìö Proyecto educativo para ense√±anza de Spring Boot

---

## Licencia

Este proyecto es **c√≥digo de demostraci√≥n educativa** sin licencia espec√≠fica.

---

## Agradecimientos

Proyecto desarrollado con fines educativos para estudiantes de inform√°tica que desean aprender:
- Arquitectura en capas
- Spring Boot y Spring Data JPA
- Validaciones con Bean Validation
- Patrones de dise√±o (DTO, Factory, Builder)
- Gesti√≥n de transacciones
- Manejo de errores
- Documentaci√≥n con OpenAPI

---

<div align="center">

**¬øTienes preguntas o sugerencias?**

Consulta el archivo [CLAUDE.md](CLAUDE.md) para detalles t√©cnicos avanzados

**‚≠ê Si este proyecto te ayud√≥ a aprender, considera darle una estrella!**

</div>